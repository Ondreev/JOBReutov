// ‚úÖ –ú–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ –≤–∞–∫–∞–Ω—Å–∏–π (–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ)
import { useEffect, useRef } from 'react'

const vacancies = [
  {
    id: 1,
    title: '–ü–æ–≤–∞—Ä',
    salary: 4500,
    desc: '–ú–æ–∂–Ω–æ –±–µ–∑ –æ–ø—ã—Ç–∞ –∏–ª–∏ —Å –Ω–µ–±–æ–ª—å—à–∏–º –æ–ø—ã—Ç–æ–º. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –º–µ–¥–∫–Ω–∏–∂–∫–∞.',
    address: '–†–µ—É—Ç–æ–≤, –ö–∞–ª–∏–Ω–∏–Ω–∞ 8',
    restaurant: '–°–∞–∫—É—Ä–∞',
    coords: [55.758938, 37.864818],
    contact: '+79099009271'
  },
  {
    id: 2,
    title: '–ö—É—Ä—å–µ—Ä',
    salary: 6000,
    desc: '–ù–∞ –∞–≤—Ç–æ. –ë–µ–∑ –æ–ø—ã—Ç–∞. 5‚Äì6 —á/–¥–µ–Ω—å. –î–æ—Å—Ç–∞–≤–∫–∞ –µ–¥—ã.',
    address: '–†–µ—É—Ç–æ–≤, –õ–µ–Ω–∏–Ω–∞ 15',
    restaurant: '–°—É—à–∏–í–æ–∫',
    coords: [55.760972, 37.861302],
    contact: '+74951400557'
  }
]

export default function MapApp() {
  const mapRef = useRef(null)

  useEffect(() => {
    const script = document.createElement('script')
    script.src = 'https://api-maps.yandex.ru/2.1/?lang=ru_RU'
    script.onload = () => {
      window.ymaps.ready(() => {
        const map = new window.ymaps.Map(mapRef.current, {
          center: [55.759, 37.863],
          zoom: 15,
          controls: ['zoomControl']
        })

        vacancies.forEach(({ title, salary, desc, address, coords, contact, restaurant }) => {
          const balloon = `
            <strong>${title}</strong><br/>
            ${restaurant} (${address})<br/>
            <em>${desc}</em><br/>
            <div style="margin-top: 6px">
              <a href='https://wa.me/${contact.replace('+', '')}' target='_blank'>
                üì≤ –°–≤—è–∑–∞—Ç—å—Å—è –≤ WhatsApp
              </a>
            </div>
          `
          const caption = `${salary}‚ÇΩ\n${title}`
          const placemark = new window.ymaps.Placemark(coords, {
            hintContent: `${salary}‚ÇΩ/–¥–µ–Ω—å`,
            iconCaption: caption,
            balloonContent: balloon
          }, {
            preset: 'islands#yellowCircleIconWithCaption'
          })
          map.geoObjects.add(placemark)
        })
      })
    }
    document.head.appendChild(script)
  }, [])

  return (
    <div style={{ height: '100vh', width: '100vw' }}>
      <div ref={mapRef} style={{ height: '100%', width: '100%' }} />
    </div>
  )
}
