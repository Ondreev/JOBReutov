<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–†–∞–±–æ—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ React –∏ ReactDOM (–¥–ª—è —Ç–µ—Å—Ç–∞ –±–µ–∑ —Å–±–æ—Ä–∫–∏) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <!-- –ü–æ–¥–∫–ª—é—á–∏–º Babel, —á—Ç–æ–±—ã –ø–∏—Å–∞—Ç—å JSX –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: sans-serif;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç MapApp -->
  <script type="text/babel">

    const { useEffect, useRef } = React

    const vacancies = [
      {
        id: 1,
        title: '–ü–æ–≤–∞—Ä',
        salary: 4500,
        desc: '–ú–æ–∂–Ω–æ –±–µ–∑ –æ–ø—ã—Ç–∞ –∏–ª–∏ —Å –Ω–µ–±–æ–ª—å—à–∏–º –æ–ø—ã—Ç–æ–º. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –º–µ–¥–∫–Ω–∏–∂–∫–∞.',
        address: '–†–µ—É—Ç–æ–≤, –ö–∞–ª–∏–Ω–∏–Ω–∞ 8',
        restaurant: '–°–∞–∫—É—Ä–∞',
        contact: '+79099009271'
      },
      {
        id: 2,
        title: '–ö—É—Ä—å–µ—Ä',
        salary: 6000,
        desc: '–ù–∞ –∞–≤—Ç–æ. –ë–µ–∑ –æ–ø—ã—Ç–∞. 5‚Äì6 —á/–¥–µ–Ω—å. –î–æ—Å—Ç–∞–≤–∫–∞ –µ–¥—ã.',
        address: '–†–µ—É—Ç–æ–≤, –õ–µ–Ω–∏–Ω–∞ 15',
        restaurant: '–°—É—à–∏–í–æ–∫',
        contact: '+74951400557'
      }
    ]

    function MapApp() {
      const mapRef = useRef(null)

      useEffect(() => {
        const script = document.createElement('script')
        script.src = 'https://api-maps.yandex.ru/2.1/?lang=ru_RU'
        script.onload = () => {
          window.ymaps.ready(initMap)
        }
        document.head.appendChild(script)

        async function initMap() {
          const map = new window.ymaps.Map(mapRef.current, {
            center: [55.759, 37.863],
            zoom: 15,
            controls: ['zoomControl']
          })

          for (const { title, salary, desc, address, contact, restaurant } of vacancies) {
            try {
              const res = await window.ymaps.geocode(address)
              const coords = res.geoObjects.get(0).geometry.getCoordinates()

              const balloon = `
                <strong>${title}</strong><br/>
                ${restaurant} (${address})<br/>
                <em>${desc}</em><br/>
                <div style="margin-top: 6px">
                  <a href='https://wa.me/${contact.replace('+', '')}' target='_blank'>
                    üì≤ –°–≤—è–∑–∞—Ç—å—Å—è –≤ WhatsApp
                  </a>
                </div>
              `

              const caption = `${salary}‚ÇΩ\n${title}`
              const placemark = new window.ymaps.Placemark(coords, {
                hintContent: `${salary}‚ÇΩ/–¥–µ–Ω—å`,
                iconCaption: caption,
                balloonContent: balloon
              }, {
                preset: 'islands#yellowCircleIconWithCaption'
              })

              map.geoObjects.add(placemark)
            } catch (err) {
              console.error(`–û—à–∏–±–∫–∞ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–∞: ${address}`, err)
            }
          }
        }
      }, [])

      return <div ref={mapRef} style={{ height: '100vh', width: '100vw' }} />
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<MapApp />)

  </script>
</body>
</html>
